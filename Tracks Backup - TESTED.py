import arcpy

# To allow overwriting outputs change overwriteOutput option to True.
arcpy.env.overwriteOutput = False

Weekly_Tracks = "https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0"
Master_Tracks_Back_up = "https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Tracks_Backup/FeatureServer/1"
Field_Crew_Master_Tracks_Back_Up = "https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Tracks_Backup/FeatureServer/0"
Weekly_Tracks_to_erase = "https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0"

    # Process: Append to Master BackUp (Append) 
arcpy.Append_management(inputs=[Weekly_Tracks], target=Master_Tracks_Back_up, schema_type="NO_TEST", field_mapping="Accuracy \"Accuracy(m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,Accuracy,-1,-1;esrignsss_speed \"Speed (km/h)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignsss_speed,-1,-1;esrignss_direction \"Direction of travel (째)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_direction,-1,-1;esriqsnsr_azimuth \"Compass reading (째)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esriqsnsr_azimuth,-1,-1;esrignss_positionsourcetype \"Position source type\" true true false 0 Long 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_positionsourcetype,-1,-1;esrignss_receiver \"Receiver Name\" true true false 50 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_receiver,0,50;esrignss_h_rms \"Horizontal Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_h_rms,-1,-1;esrignss_v_rms \"Vertical Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_v_rms,-1,-1;esrignss_latitude \"Latitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_latitude,-1,-1;esrignss_longitude \"Longitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_longitude,-1,-1;esrignss_altitude \"Altitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_altitude,-1,-1;esrignss_pdop \"PDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_pdop,-1,-1;esrignss_hdop \"HDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_hdop,-1,-1;esrignss_vdop \"VDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_vdop,-1,-1;esrignss_fixtype \"Fix Type\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_fixtype,-1,-1;esrignss_correctionage \"Correction Age\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_correctionage,-1,-1;esrignss_stationid \"Station ID\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_stationid,-1,-1;esrignss_numsats \"Number of Satellites\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_numsats,-1,-1;esrignss_fixdatetime \"Fix Time\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_fixdatetime,-1,-1;esrignss_avg_h_rms \"Average Horizontal Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_avg_h_rms,-1,-1;esrignss_avg_v_rms \"Average Vertical Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_avg_v_rms,-1,-1;esrignss_avg_positions \"Averaged Positions\" true true false 0 Long 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_avg_positions,-1,-1;esrignss_h_stddev \"Standard Deviation (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,esrignss_h_stddev,-1,-1;GlobalID \"GlobalID\" false false true 38 GlobalID 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,GlobalID,-1,-1;CreationDate \"CreationDate\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,CreationDate,-1,-1;Creator \"Creator\" true true false 128 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,Creator,0,128;EditDate \"EditDate\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,EditDate,-1,-1;Editor \"Editor\" true true false 128 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,Editor,0,128;map \"map\" true true false 256 Text 0 0,First,#;original_creator \"Original Creator\" true true false 255 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,Creator,0,128;original_createdate \"Original Create Date\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_2020_Recon/FeatureServer/0,CreationDate,-1,-1", subtype="", expression="")[0]

    # Process: Append to FIeld Crew Master BackUp (Append) 
arcpy.Append_management(inputs=[Weekly_Tracks], target=Field_Crew_Master_Tracks_Back_Up, schema_type="NO_TEST", field_mapping="Accuracy \"Accuracy(m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,Accuracy,-1,-1;esrignsss_speed \"Speed (km/h)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignsss_speed,-1,-1;esrignss_direction \"Direction of travel (째)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_direction,-1,-1;esriqsnsr_azimuth \"Compass reading (째)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esriqsnsr_azimuth,-1,-1;esrignss_positionsourcetype \"Position source type\" true true false 0 Long 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_positionsourcetype,-1,-1;esrignss_receiver \"Receiver Name\" true true false 50 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_receiver,0,50;esrignss_h_rms \"Horizontal Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_h_rms,-1,-1;esrignss_v_rms \"Vertical Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_v_rms,-1,-1;esrignss_latitude \"Latitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_latitude,-1,-1;esrignss_longitude \"Longitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_longitude,-1,-1;esrignss_altitude \"Altitude\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_altitude,-1,-1;esrignss_pdop \"PDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_pdop,-1,-1;esrignss_hdop \"HDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_hdop,-1,-1;esrignss_vdop \"VDOP\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_vdop,-1,-1;esrignss_fixtype \"Fix Type\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_fixtype,-1,-1;esrignss_correctionage \"Correction Age\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_correctionage,-1,-1;esrignss_stationid \"Station ID\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_stationid,-1,-1;esrignss_numsats \"Number of Satellites\" true true false 0 Short 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_numsats,-1,-1;esrignss_fixdatetime \"Fix Time\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_fixdatetime,-1,-1;esrignss_avg_h_rms \"Average Horizontal Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_avg_h_rms,-1,-1;esrignss_avg_v_rms \"Average Vertical Accuracy (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_avg_v_rms,-1,-1;esrignss_avg_positions \"Averaged Positions\" true true false 0 Long 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_avg_positions,-1,-1;esrignss_h_stddev \"Standard Deviation (m)\" true true false 0 Double 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,esrignss_h_stddev,-1,-1;GlobalID \"GlobalID\" false false true 38 GlobalID 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,GlobalID,-1,-1;CreationDate \"CreationDate\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,CreationDate,-1,-1;Creator \"Creator\" true true false 128 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,Creator,0,128;EditDate \"EditDate\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,EditDate,-1,-1;Editor \"Editor\" true true false 128 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,Editor,0,128;map \"map\" true true false 256 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,map,0,256;original_creator \"Original Creator\" true true false 75 Text 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,Creator,0,128;original_createdate \"Original Create Date\" true true false 8 Date 0 0,First,#,https://services1.arcgis.com/ypdMhhEhrtBXLtQv/arcgis/rest/services/SWFL_Tracks_2020/FeatureServer/0,CreationDate,-1,-1", subtype="", expression="")[0]

    # Process: Delete Features (Delete Features) 
arcpy.DeleteFeatures_management(in_features=Weekly_Tracks_to_erase)[0]
